ГдеМоё (продолжение 4)
Ты — ИИ-агент (Codex),опытный дизайнер, UX/UI дизайнер, опытный Senior full-stack разработчик, архитектор и интегратор ИИ-систем. 
- Выполняй задание максимально самостоятельно: пиши код, создавай файлы и каталоги, настраивай сборку, компиляцию и упаковку проектов. Все действия, которые ты можешь выполнить сам в своей среде, делай сам. Если какие-то шаги требуют моих действий на моём компьютере или NAS, ты обязан выдать максимально подробные и пошаговые инструкции: какие файлы уже должны быть созданы, какие команды нужно выполнить, в какой операционной системе и в каком каталоге, каких результатов ожидать.
- Изменения сам протестируй, сам поправь ошибки, сделай юнитесты на всё. Сам сформируй apk, сделай сам все измения в docker и в БД.
- По изменения обнови документацию.
- Продолжай обновлять описание что реализовано и то что осталось реализовать.
- При обновлении "changes.md"сохраняй историю.
- Продолжай вести реестр дефектов с приоритетами, и статусами.

Важно:
- Максимально автоматизируй всё, что можешь.
- Минимизируй количество вопросов ко мне.
- Если что-то невозможно сделать автоматически в твоей среде, опиши чёткую инструкцию для меня.

Название приложения: "ГдеМоё"

Задача:
Переработай интерфейс мобильного приложения на Android следующим образом:
- Быстрое и максимально простое внесение информации о вещах.
- Интуитивное управление расположениями (дом/квартира/комната/шкаф/ящик/коробка).
- Удобную работу с медиа (фото/видео).
- Отдельный, понятный поток проверки и корректировки результатов работы ИИ (распознавание вещей по фото/видео).
- Общую структуру навигации и взаимодействия, которая будет масштабироваться по мере развития функционала.
- не должна теряться функциональность приложения.
- Используй описание в папке docs: ux_ui_task.md, ux_ui_koncept.md, ux_ui_low-fidelity.md, ux_ui_status.md

Используй и дополняй документацию в директории "docs", например:
task.md
architecture.md
ux_ui_task.md
ux_ui_koncept.md
ux_ui_low-fidelity.md
ux_ui_status.md
data_model.md
ai_integration.md
backend_deploy_on_nas.md
build_and_run.md
changes.md
defects.md

Если какой-то шаг ты не можешь выполнить сам в своей среде, ты обязан максимально подробно описать, что именно должен сделать пользователь (я): какие команды выполнить, в каком порядке, где и какие файлы должны быть до и после выполнения.


## План доработки (медиа-захват, загрузка на NAS, AI-анализ)
- Аналитика и требования: уточнить UX-флоу (карточка, Quick Add, AI Review), ограничения по размерам/таймаутам, опции scope; зафиксировать API контракты (`item_id`, `location_id`, `analyze`, `source`, статусы).
- Backend: расширить `/media/upload` (метаданные, hash/size, thumbs, optional link to item/location, analyze flag); добавить `GET /media/{id}` с прогрессом; валидация mime/размеров; логика автопривязки по AI; обновить AI видео-параметры и логи; очистка tmp; документация.
- Mobile (UI/UX): в карточке — кнопки «Снять фото/Записать видео», прогресс загрузки/AI, показ bbox; Quick Add — быстрый capture без item с переходом в AI Review; ручное подтверждение/отклонение связей; отображение статусов.
- Mobile (техника): FileProvider + `TakePicture`/`CaptureVideo`; загрузка с новыми полями (`source`, `analyze`, `item_id` optional); очередь/ретраи, отмена; scoped storage разрешения; отображение локального превью → серверный URL.
- AI/автопривязка: правила сопоставления с карточками/локациями, создание черновиков «требует подтверждения», UX подтверждения связей.
- Тесты: backend unit/integration (`upload`, авто-анализ, валидация, прогресс); mobile UI/инструментальные (capture, загрузка, статусы, bbox, подтверждения); E2E: фото/видео → NAS → AI Review → привязка/подтверждение.
- Развёртывание/документация: обновить README/build_and_run, описать новые эндпоинты, параметры мобильной сборки, ограничения/лимиты, чек-лист проверок на NAS.

### Детализация шага 1. Аналитика и требования
- UX-флоу:
  - Карточка предмета: снять фото/видео → мгновенное превью → загрузка → показ прогресса → статус AI (pending/in_progress/done/failed) → просмотр bbox → подтверждение/отклонение привязки к карточке/локации.
  - Quick Add: быстрый capture без карточки → загрузка в выбранный scope → автоматическая попытка сопоставить с существующими карточками/локациями → показ предложений и подтверждения → переход в AI Review.
  - AI Review: список детекций с медиа, статусами и bbox → действия accept/reject/link/create-new → возможность открыть предмет/создать черновик.
- Ограничения/таймауты:
  - Фото: рекомендуемый объём 3–5 МБ; допустимые форматы JPG/PNG/HEIC; таймаут загрузки 15–30 c; превышение — ошибка с ретраем.
  - Видео: рекомендуемый объём ≤100 МБ; длина до 5 минут; формат MP4 (H.264/AAC); таймаут загрузки 60–120 c; обработка AI может занять до 2–3 минут (с прогрессом/статусами).
  - Ограничить mime whitelist (image/jpeg, image/png, image/heic, video/mp4) и размер (конфиг на бэкенде), отдавать понятные ошибки.
- Scope:
  - Значения `public`/`private` выбирает пользователь в настройках; сервер принимает присланное значение без автопереключения.
  - Путь на NAS формируется с учётом scope и workspace/user.
- API контракты (фиксируем поля):
  - `POST /api/v1/media/upload`: multipart `file`; form `workspace_id` (int), `owner_user_id` (int), `media_type` (`photo|video|document`), `scope` (`public|private`), `subdir` (строка), `item_id` (optional int), `location_id` (optional int), `analyze` (bool, default true), `source` (`camera|gallery|share|upload`), `client_created_at` (ISO).
  - Ответ upload: `id`, `path`, `mime_type`, `thumb_path?`, `analysis` {`detection_ids` или `detection_id`, `status`}.
  - `GET /api/v1/media/{id}`: возвращает метаданные (size_bytes, hash, mime, scope, paths) + текущий статус анализа (`pending|in_progress|done|failed`) и список bbox (если есть).
  - Статусы AI: pending → in_progress → done/failed; детектированные объекты имеют decision (pending/accepted/rejected).
